<!DOCTYPE html>
<html lang="uk">
<head>
    <title><?php echo $this->title; ?></title>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    <meta name="description" content="<?= $this->description ?>"/>
    <meta name="keywords" content="<?= $this->keywords ?>"/>

    <!--[if lte IE 8]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE8.js"></script>
    <![endif]-->
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
    <link rel="stylesheet" type="text/css" href="/static/default/css/style.css" media="screen"/>
    <link rel="stylesheet" type="text/css" href="/static/default/css/adaptive.css" media="screen"/>
    <link rel="stylesheet" type="text/css" href="/static/default/css/fancybox.css" media="screen"/>

    <script type="text/javascript" src="/static/default/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="/static/default/js/script.js"></script>
    <?=$this->headScript()?>
    <script>
        function changeCity(ele)
        {
            $('#empty_area').html('– Сначала выберите город –');
            var cityId = ele.val();
            $('.area_inp').hide();
            $('.area_in_city_'+cityId).show();
        }

        function sendSubscribe(form_ele)
        {
            var url = '<?=$this->url(array(),'default-subscribe-add-ajax')?>';

            var form = $(form_ele);
            var args = {
                'city_id': '<?=$this->currentCity?$this->currentCity->getId():0?>',
                'area_id': '<?=isset($this->area)?$this->area->getId():0?>',
                'email': form.find('.input_subscribe').val()
            };

            $.post( url, args, function( data ) {
                if (typeof data.error != 'undefined') {
                    $.each( data.error, function( key, value ) {
                        alert( key + ": " + value );
                    });
                } else {
                    alert('<p>Спасибо Вы подписаны на новости!</p>');
                    form.find('.input_subscribe').val('');
                }
                console.log(data);
            }, "json");


            return false;
        }
    </script>
</head>
<body>
    <?php echo $this->partial('blocks/header.phtml', array (
                                                           'menu' => $this->menu,
                                                           'blocks' => $this->blocks,
                                                           'siteSetings' => $this->siteSetings,
                                                           'cityContent' => $this->currentCityContent,
                                                           'area' => isset($this->area)?$this->area:false
                                                     )) ?>
    <section class="container">
        <div class="wrapper">
            <?php echo $this->layout()->content ?>
        </div>
    </section>
    <?php echo $this->partial('blocks/footer.phtml', array (
                                                           'blocks'      => $this->blocks,
                                                           'siteSetings' => $this->siteSetings
                                                     )) ?>
    <script>
        $(function(){
            changeCity($('#<?=$this->currentCity?$this->currentCity->getUrl():0?>'));
        });
    </script>
</body>
</html>